<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Sebastian Raschka">
  <link rel="shortcut icon" href="../../../img/favicon.ico">
  <title>McNemar's Test - mlxtend</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  <link href="../../../cinder/css/base.css" rel="stylesheet">
  <link href="../../../cinder/css/bootstrap-custom.css" rel="stylesheet">
  <link href="../../../cinder/css/bootstrap-custom.min.css" rel="stylesheet">
  <link href="../../../cinder/css/cinder.css" rel="stylesheet">
  <link href="../../../cinder/css/font-awesome-4.0.3.css" rel="stylesheet">
  <link href="../../../cinder/css/highlight.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "McNemar's Test";
    var mkdocs_page_input_path = "user_guide/evaluate/mcnemar.md";
    var mkdocs_page_url = "/mlxtend/user_guide/evaluate/mcnemar/";
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-38457794-2', 'rasbt.github.io/mlxtend/');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> mlxtend</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">User Guide</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../USER_GUIDE_INDEX/">User Guide Index</a>
                </li>
                <li class="">
                    
    <span class="caption-text">classifier</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../classifier/Adaline/">Adaptive Linear Neuron -- Adaline</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../classifier/EnsembleVoteClassifier/">EnsembleVoteClassifier</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../classifier/LogisticRegression/">Logistic Regression</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../classifier/MultiLayerPerceptron/">Neural Network - Multilayer Perceptron</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../classifier/Perceptron/">Perceptron</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../classifier/SoftmaxRegression/">Softmax Regression</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../classifier/StackingClassifier/">StackingClassifier</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../classifier/StackingCVClassifier/">StackingCVClassifier</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">cluster</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../cluster/Kmeans/">Kmeans</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">data</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../data/autompg_data/">Auto MPG</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../data/boston_housing_data/">Boston Housing Data</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../data/iris_data/">Iris Dataset</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../data/loadlocal_mnist/">Load the MNIST Dataset from Local Files</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../data/make_multiplexer_dataset/">Make Multiplexer Dataset</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../data/mnist_data/">MNIST Dataset</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../data/three_blobs_data/">Three Blobs Dataset</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../data/wine_data/">Wine Dataset</a>
                </li>
    </ul>
                </li>
                <li class=" current">
                    
    <span class="caption-text">evaluate</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../bootstrap/">Bootstrap</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../bootstrap_point632_score/">bootstrap_point632_score</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../BootstrapOutOfBag/">BootstrapOutOfBag</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../cochrans_q/">Cochran's Q Test</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../combined_ftest_5x2cv/">5x2cv combined *F* test</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../confusion_matrix/">Confusion Matrix</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../feature_importance_permutation/">Feature Importance Permutation</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../ftest/">F-Test</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../lift_score/">Lift Score</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../mcnemar_table/">Contigency Table for McNemar's Test</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../mcnemar_tables/">Contigency Tables for McNemar's Test and Cochran's Q Test</a>
                </li>
                <li class="toctree-l3 current">
                    
    <a class="current" href="./">McNemar's Test</a>
    <ul class="subnav">
            
    <li class="toctree-l4"><a href="#mcnemars-test">McNemar's Test</a></li>
    
        <ul>
        
            <li><a class="toctree-l5" href="#overview">Overview</a></li>
        
            <li><a class="toctree-l5" href="#example-1-creating-2x2-contigency-tables">Example 1 - Creating 2x2 Contigency tables</a></li>
        
            <li><a class="toctree-l5" href="#example-2-mcnemars-test-for-scenario-b">Example 2 - McNemar's Test for Scenario B</a></li>
        
            <li><a class="toctree-l5" href="#example-3-mcnemars-test-for-scenario-a">Example 3 - McNemar's Test for Scenario A</a></li>
        
            <li><a class="toctree-l5" href="#api">API</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../paired_ttest_5x2cv/">5x2cv paired *t* test</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../paired_ttest_kfold_cv/">K-fold cross-validated paired *t* test</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../paired_ttest_resampled/">Resampled paired *t* test</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../permutation_test/">Permutation Test</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../PredefinedHoldoutSplit/">PredefinedHoldoutSplit</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../RandomHoldoutSplit/">RandomHoldoutSplit</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../scoring/">Scoring</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">feature_extraction</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../feature_extraction/LinearDiscriminantAnalysis/">Linear Discriminant Analysis</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../feature_extraction/PrincipalComponentAnalysis/">Principal Component Analysis</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../feature_extraction/RBFKernelPCA/">RBFKernelPCA</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">feature_selection</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../feature_selection/ColumnSelector/">ColumnSelector</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../feature_selection/ExhaustiveFeatureSelector/">Exhaustive Feature Selector</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../feature_selection/SequentialFeatureSelector/">Sequential Feature Selector</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">file_io</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../file_io/find_filegroups/">Find Filegroups</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../file_io/find_files/">Find Files</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">frequent_patterns</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../frequent_patterns/apriori/">Apriori</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../frequent_patterns/association_rules/">Association rules</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">general concepts</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../general_concepts/activation-functions/">Activation Functions for Artificial Neural Networks</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../general_concepts/gradient-optimization/">Gradient Descent and Stochastic Gradient Descent</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../general_concepts/linear-gradient-derivative/">Deriving the Gradient Descent Rule for Linear Regression and Adaline</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../general_concepts/regularization-linear/">Regularization of Generalized Linear Models</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">image</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../image/extract_face_landmarks/">Extract Face Landmarks</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">math</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../math/num_combinations/">Compute the Number of Combinations</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../math/num_permutations/">Compute the Number of Permutations</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../math/vectorspace_dimensionality/">Vectorspace Dimensionality</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../math/vectorspace_orthonormalization/">Vectorspace Orthonormalization</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">plotting</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../plotting/category_scatter/">Scatterplot with Categories</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../plotting/checkerboard_plot/">Checkerboard Plot</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../plotting/ecdf/">Empirical Cumulative Distribution Function Plot</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../plotting/enrichment_plot/">Enrichment Plot</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../plotting/plot_confusion_matrix/">Confusion Matrix</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../plotting/plot_decision_regions/">Plotting Decision Regions</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../plotting/plot_learning_curves/">Plotting Learning Curves</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../plotting/plot_linear_regression/">Linear Regression Plot</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../plotting/plot_sequential_feature_selection/">Plot Sequential Feature Selection</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../plotting/scatterplotmatrix/">Scatter Plot Matrix</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../plotting/stacked_barplot/">Stacked Barplot</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">preprocessing</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../preprocessing/CopyTransformer/">CopyTransformer</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../preprocessing/DenseTransformer/">DenseTransformer</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../preprocessing/MeanCenterer/">Mean Centerer</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../preprocessing/minmax_scaling/">MinMax Scaling</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../preprocessing/one-hot_encoding/">One hot encoding</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../preprocessing/shuffle_arrays_unison/">Shuffle Arrays in Unison</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../preprocessing/standardize/">Standardize</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../preprocessing/TransactionEncoder/">TransactionEncoder</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">regressor</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../regressor/LinearRegression/">LinearRegression</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../regressor/StackingCVRegressor/">StackingCVRegressor</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../regressor/StackingRegressor/">StackingRegressor</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">text</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../text/generalize_names/">Generalize Names</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../text/generalize_names_duplcheck/">Generalize Names & Duplicate Checking</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../text/tokenizer/">Tokenizer</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">utils</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../utils/Counter/">Counter</a>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">API</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../api_subpackages/mlxtend.classifier/">Mlxtend.classifier</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../api_subpackages/mlxtend.cluster/">Mlxtend.cluster</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../api_subpackages/mlxtend.data/">Mlxtend.data</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../api_subpackages/mlxtend.evaluate/">Mlxtend.evaluate</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../api_subpackages/mlxtend.feature_extraction/">Mlxtend.feature extraction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../api_subpackages/mlxtend.feature_selection/">Mlxtend.feature selection</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../api_subpackages/mlxtend.file_io/">Mlxtend.file io</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../api_subpackages/mlxtend.frequent_patterns/">Mlxtend.frequent patterns</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../api_subpackages/mlxtend.plotting/">Mlxtend.plotting</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../api_subpackages/mlxtend.preprocessing/">Mlxtend.preprocessing</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../api_subpackages/mlxtend.regressor/">Mlxtend.regressor</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../api_subpackages/mlxtend.text/">Mlxtend.text</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../api_subpackages/mlxtend.utils/">Mlxtend.utils</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../../installation/">Installation</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">About</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../CHANGELOG/">Release Notes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../CONTRIBUTING/">How To Contribute</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../contributors/">Contributors</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../license/">License</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../cite/">Citing Mlxtend</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../discuss/">Discuss</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">mlxtend</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
        
          <li>evaluate &raquo;</li>
        
      
        
          <li>User Guide &raquo;</li>
        
      
    
    <li>McNemar's Test</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/rasbt/mlxtend/edit/master/docs/user_guide/evaluate/mcnemar.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="mcnemars-test">McNemar's Test</h1>
<p>McNemar's test for paired nominal data</p>
<blockquote>
<p><code>from mlxtend.evaluate import mcnemar</code>    </p>
</blockquote>
<h2 id="overview">Overview</h2>
<p>McNemar's Test [1] (sometimes also called "within-subjects chi-squared test") is a statistical test for paired nominal data. In context of machine learning (or statistical) models, we can use McNemar's Test to compare the predictive accuracy of two models. McNemar's test is based on a 2 times 2 contigency table of the two model's predictions.</p>
<h3 id="mcnemars-test-statistic">McNemar's Test Statistic</h3>
<p>In McNemar's Test, we formulate the null hypothesis that the probabilities <script type="math/tex">p(b)</script> and <script type="math/tex">p(c)</script> are the same, or in simplified terms: None of the two models performs better than the other. Thus, the alternative hypothesis is that the performances of the two models are not equal.</p>
<p><img alt="" src="../mcnemar_table_files/mcnemar_contingency_table.png" /></p>
<p>The McNemar test statistic ("chi-squared") can be computed as follows:</p>
<p>
<script type="math/tex; mode=display">\chi^2 = \frac{(b - c)^2}{(b + c)},</script>
</p>
<p>If the sum of cell c and b is sufficiently large, the <script type="math/tex">\chi^2</script> value follows a chi-squared distribution with one degree of freedom. After setting a significance threshold, e.g,. <script type="math/tex">\alpha=0.05</script> we can compute the p-value -- assuming that the null hypothesis is true, the p-value is the probability of observing this empirical (or a larger) chi-squared value. If the p-value is lower than our chosen significance level, we can reject the null hypothesis that the two model's performances are equal.</p>
<h3 id="continuity-correction">Continuity Correction</h3>
<p>Approximately 1 year after Quinn McNemar published the McNemar Test [1], Edwards [2] proposed a continuity corrected version, which is the more commonly used variant today:</p>
<p>
<script type="math/tex; mode=display">\chi^2 = \frac{( \mid b - c \mid - 1)^2}{(b + c)}.</script>
</p>
<h3 id="exact-p-values">Exact p-values</h3>
<p>As mentioned earlier, an exact binomial test is recommended for small sample sizes (<script type="math/tex">b + c < 25</script> [3]), since the chi-squared value is may not be well-approximated by the chi-squared distribution. The exact p-value can be computed as follows:</p>
<p>
<script type="math/tex; mode=display">p = 2 \sum^{n}_{i=b} \binom{n}{i} 0.5^i (1 - 0.5)^{n-i},</script>
</p>
<p>where <script type="math/tex">n = b + c</script>, and the factor <script type="math/tex">2</script> is used to compute the two-sided p-value.</p>
<h3 id="example">Example</h3>
<p>For instance, given that 2 models have a accuracy of with a 99.7% and 99.6% a 2x2 contigency table can provide further insights for model selection.</p>
<p><img alt="" src="../mcnemar_table_files/mcnemar_contingency_table_ex1.png" /></p>
<p>In both subfigure A and B, the predictive accuracies of the two models are as follows:</p>
<ul>
<li>model 1 accuracy: 9,960 / 10,000 = 99.6%</li>
<li>model 2 accuracy: 9,970 / 10,000 = 99.7%</li>
</ul>
<p>Now, in subfigure A, we can see that model 2 got 11 predictions right that model 1 got wrong. Vice versa, model 2 got 1 prediction right that model 2 got wrong. Thus, based on this 11:1 ratio, we may conclude that model 2 performs substantially better than model 1. However, in subfigure B, the ratio is 25:15, which is less conclusive about which model is the better one to choose.</p>
<p>In the following coding examples, we will use these 2 scenarios A and B to illustrate McNemar's test.</p>
<h3 id="references">References</h3>
<ul>
<li>[1] McNemar, Quinn, 1947. "<a href="http://link.springer.com/article/10.1007%2FBF02295996">Note on the sampling error of the difference between correlated proportions or percentages</a>". Psychometrika. 12 (2): 153–157.</li>
<li>[2] Edwards AL: Note on the “correction for continuity” in testing the significance of the difference between correlated proportions. Psychometrika. 1948, 13 (3): 185-187. 10.1007/BF02289261.</li>
<li>[3] https://en.wikipedia.org/wiki/McNemar%27s_test</li>
</ul>
<h2 id="example-1-creating-2x2-contigency-tables">Example 1 - Creating 2x2 Contigency tables</h2>
<p>The <code>mcnemar</code> funtion expects a 2x2 contingency table as a NumPy array that is formatted as follows:</p>
<p><img alt="" src="../mcnemar_table_files/mcnemar_contingency_table.png" /></p>
<p>Such a contigency matrix can be created by using the <code>mcnemar_table</code> function from <code>mlxtend.evaluate</code>. For example:</p>
<pre><code class="python">import numpy as np
from mlxtend.evaluate import mcnemar_table

# The correct target (class) labels
y_target = np.array([0, 0, 0, 0, 0, 1, 1, 1, 1, 1])

# Class labels predicted by model 1
y_model1 = np.array([0, 1, 0, 0, 0, 1, 1, 0, 0, 0])

# Class labels predicted by model 2
y_model2 = np.array([0, 0, 1, 1, 0, 1, 1, 0, 0, 0])

tb = mcnemar_table(y_target=y_target, 
                   y_model1=y_model1, 
                   y_model2=y_model2)

print(tb)
</code></pre>

<pre><code>[[4 1]
 [2 3]]
</code></pre>
<h2 id="example-2-mcnemars-test-for-scenario-b">Example 2 - McNemar's Test for Scenario B</h2>
<p>No, let us continue with the example mentioned in the overview section and assume that we already computed the 2x2 contigency table:</p>
<p><img alt="" src="../mcnemar_files/mcnemar_scenario_b.png" /></p>
<pre><code class="python">import numpy as np

tb_b = np.array([[9945, 25],
                 [15, 15]])
</code></pre>

<p>To test the null hypothesis that the predictive performance of two models are equal (using a significance level of <script type="math/tex">\alpha=0.05</script>), we can conduct a corrected McNemar Test for computing the chi-squared and p-value as follows:</p>
<pre><code class="python">from mlxtend.evaluate import mcnemar

chi2, p = mcnemar(ary=tb_b, corrected=True)
print('chi-squared:', chi2)
print('p-value:', p)
</code></pre>

<pre><code>chi-squared: 2.025
p-value: 0.154728923485
</code></pre>
<p>Since the p-value is larger than our assumed significance threshold (<script type="math/tex">\alpha=0.05</script>), we cannot reject our null hypothesis and assume that there is no significant difference between the two predictive models.</p>
<h2 id="example-3-mcnemars-test-for-scenario-a">Example 3 - McNemar's Test for Scenario A</h2>
<p>In contrast to scenario B (Example 2), the sample size in scenario A is relatively small (b + c = 11  + 1 = 12) and smaller than the recommended 25 [3] to approximate the computed chi-square value by the chi-square distribution well.</p>
<p><img alt="" src="../mcnemar_files/mcnemar_scenario_a.png" /></p>
<p>In this case, we need to compute the exact p-value from the binomial distribution:</p>
<pre><code class="python">from mlxtend.evaluate import mcnemar
import numpy as np

tb_a = np.array([[9959, 11],
                 [1, 29]])

chi2, p = mcnemar(ary=tb_a, exact=True)

print('chi-squared:', chi2)
print('p-value:', p)
</code></pre>

<pre><code>chi-squared: None
p-value: 0.005859375
</code></pre>
<p>Assuming that we conducted this test also with a significance level of <script type="math/tex">\alpha=0.05</script>, we can reject the null-hypothesis that both models perform equally well on this dataset, since the p-value (<script type="math/tex">p \approx 0.006</script>) is smaller than <script type="math/tex">\alpha</script>.</p>
<h2 id="api">API</h2>
<p><em>mcnemar(ary, corrected=True, exact=False)</em></p>
<p>McNemar test for paired nominal data</p>
<p><strong>Parameters</strong></p>
<ul>
<li>
<p><code>ary</code> : array-like, shape=[2, 2]</p>
<p>2 x 2 contigency table (as returned by evaluate.mcnemar_table),
where
a: ary[0, 0]: # of samples that both models predicted correctly
b: ary[0, 1]: # of samples that model 1 got right and model 2 got wrong
c: ary[1, 0]: # of samples that model 2 got right and model 1 got wrong
d: aryCell [1, 1]: # of samples that both models predicted incorrectly</p>
</li>
<li>
<p><code>corrected</code> : array-like, shape=[n_samples] (default: True)</p>
<p>Uses Edward's continuity correction for chi-squared if <code>True</code></p>
</li>
<li>
<p><code>exact</code> : bool, (default: False)</p>
<p>If <code>True</code>, uses an exact binomial test comparing b to
a binomial distribution with n = b + c and p = 0.5.
It is highly recommended to use <code>exact=True</code> for sample sizes &lt; 25
since chi-squared is not well-approximated
by the chi-squared distribution!</p>
</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li>
<p><code>chi2, p</code> : float or None, float</p>
<p>Returns the chi-squared value and the p-value;
if <code>exact=True</code> (default: <code>False</code>), <code>chi2</code> is <code>None</code></p>
</li>
</ul>
<p><strong>Examples</strong></p>
<pre><code>For usage examples, please see
[http://rasbt.github.io/mlxtend/user_guide/evaluate/mcnemar/](http://rasbt.github.io/mlxtend/user_guide/evaluate/mcnemar/)
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../paired_ttest_5x2cv/" class="btn btn-neutral float-right" title="5x2cv paired *t* test">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../mcnemar_tables/" class="btn btn-neutral" title="Contigency Tables for McNemar's Test and Cochran's Q Test"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Copyright &copy; 2014-2018 <a href="http://sebastianraschka.com">Sebastian Raschka</a></p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/rasbt/mlxtend/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../mcnemar_tables/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../paired_ttest_5x2cv/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme.js" defer></script>
      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" defer></script>
      <script src="../../../mathjaxhelper.js" defer></script>
      <script src="../../../search/main.js" defer></script>

</body>
</html>
