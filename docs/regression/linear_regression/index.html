<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Sebastian Raschka">
        <link rel="canonical" href="http://rasbt.github.io/mlxtend/docs/regression/linear_regression/">
        <link rel="shortcut icon" href="../../../img/favicon.ico">

	<title>Linear regression - mlxtend</title>

        <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../../css/highlight.css">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../../..">mlxtend</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../../..">Home</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">classifier</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../classifier/neuralnet_mlp/">Neuralnet mlp</a>
</li>

        
            
<li >
    <a href="../../classifier/adaline/">Adaline</a>
</li>

        
            
<li >
    <a href="../../classifier/perceptron/">Perceptron</a>
</li>

        
            
<li >
    <a href="../../classifier/logistic_regression/">Logistic regression</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">pandas</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../pandas/minmax_scaling/">Minmax scaling</a>
</li>

        
            
<li >
    <a href="../../pandas/standardizing/">Standardizing</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">sklearn</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../sklearn/sequential_backward_selection/">Sequential backward selection</a>
</li>

        
            
<li >
    <a href="../../sklearn/column_selector/">Column selector</a>
</li>

        
            
<li >
    <a href="../../sklearn/ensemble_classifier/">Ensemble classifier</a>
</li>

        
            
<li >
    <a href="../../sklearn/dense_transformer/">Dense transformer</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">evaluate</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../evaluate/plot_decision_regions/">Plot decision regions</a>
</li>

        
            
<li >
    <a href="../../evaluate/plot_learning_curves/">Plot learning curves</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">matplotlib</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../matplotlib/category_scatter/">Category scatter</a>
</li>

        
            
<li >
    <a href="../../matplotlib/enrichment_plot/">Enrichment plot</a>
</li>

        
            
<li >
    <a href="../../matplotlib/stacked_barplot/">Stacked barplot</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">regression</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../plot_linear_regression_fit/">Plot linear regression fit</a>
</li>

        
            
<li class="active">
    <a href="./">Linear regression</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">preprocessing</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../preprocessing/mean_centerer/">Mean centerer</a>
</li>

        
            
<li >
    <a href="../../preprocessing/shuffle_arrays_unison/">Shuffle arrays unison</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">file_io</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../file_io/find_files/">Find files</a>
</li>

        
            
<li >
    <a href="../../file_io/find_filegroups/">Find filegroups</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">math</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../math/combinations/">Combinations</a>
</li>

        
            
<li >
    <a href="../../math/permutations/">Permutations</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">text</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../text/generalize_names/">Generalize names</a>
</li>

        
            
<li >
    <a href="../../text/generalize_names_duplcheck/">Generalize names duplcheck</a>
</li>

        
            
<li >
    <a href="../../text/tokenizer/">Tokenizer</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">data</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../data/iris/">Iris</a>
</li>

        
            
<li >
    <a href="../../data/wine/">Wine</a>
</li>

        
            
<li >
    <a href="../../data/autompg/">Autompg</a>
</li>

        
            
<li >
    <a href="../../data/mnist/">Mnist</a>
</li>

        
    </ul>
  </li>

                        
                        </ul>
                    </li>
                
                
                
                    <li >
                        <a href="../../../changelog/">Changelog</a>
                    </li>
                
                
                
                    <li >
                        <a href="../../../installation/">Installation</a>
                    </li>
                
                
                
                    <li >
                        <a href="../../../contributing/">Contributing</a>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                    <li >
                        <a rel="next" href="../plot_linear_regression_fit/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../../preprocessing/mean_centerer/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                
                    <li>
                        <a href="https://github.com/rasbt/mlxtend">
                            
                                <i class="fa fa-github"></i>
                            
                            GitHub
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#linear-regression">Linear Regression</a></li>
        
            <li><a href="#example-1-normal-equation">Example 1 - Normal Equation</a></li>
        
            <li><a href="#example-2-gradient-descent">Example 2 - Gradient Descent</a></li>
        
            <li><a href="#example-3-stochastic-gradient-descent">Example 3 - Stochastic Gradient Descent</a></li>
        
            <li><a href="#default-parameters">Default Parameters</a></li>
        
            <li><a href="#methods">Methods</a></li>
        
    
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<p>mlxtend
Sebastian Raschka, last updated: 06/18/2015</p>
<h1 id="linear-regression">Linear Regression</h1>
<blockquote>
<p>from mlxtend.regression import LinearRegression</p>
</blockquote>
<p>Implementation of a linear regression model for performing ordinary least squares regression using one of the following three approaches:</p>
<ul>
<li>normal equation (closed-form solution)</li>
<li>gradient descent</li>
<li>stochastic gradient descent </li>
</ul>
<p>For more usage examples please see the <a href="http://nbviewer.ipython.org/github/rasbt/mlxtend/blob/master/docs/examples/regression__linear_regression.ipynb">IPython Notebook</a>.</p>
<hr>

<p><br></p>
<h3 id="example-1-normal-equation">Example 1 - Normal Equation</h3>
<p>The closed-form solution should be preferred for "smaller" datasets where calculating (a "costly") is not a concern. For very large datasets, or datasets where the inverse of [<strong>X</strong>^T <strong>X</strong>] may not exist (the matrix is non-invertible or singular, e.g., in case of perfect multicollinearity), the gradient descent or stochastic gradient descent approaches are to be preferred.</p>
<p>The linear function (linear regression model) is defined as:</p>
<p><img alt="" src=".././img/regression_ols_linreg_1.png" /></p>
<p>where <em>y</em> is the response variable, <strong><em>x</em></strong> is an <em>m</em>-dimensional sample vector, and <strong><em>w</em></strong> is the weight vector (vector of coefficients). Note that <em>w_0</em> represents the y-axis intercept of the model and therefore <em>x_0</em>=1.  </p>
<p>Using the closed-form solution (normal equation), we can calculate the weights of the model as follows:</p>
<p><img alt="" src=".././img/regression_ols_linreg_2.png" /></p>
<p>where <strong><em>X</em></strong> is the matrix of the data samples. After obtaining the weight, the intercept (w_0) can be calculated from the difference of the true and predicted average responses: </p>
<p><img alt="" src=".././img/regression_ols_linreg_3.png" /></p>
<pre><code>&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; X = np.array([ 1, 2, 3, 4, 5])[:, np.newaxis]
&gt;&gt;&gt; y = np.array([ 1, 2, 3, 4, 5])

&gt;&gt;&gt; import matplotlib.pyplot as plt
&gt;&gt;&gt; def lin_regplot(X, y, model):
...     plt.scatter(X, y, c='blue')
...     plt.plot(X, model.predict(X), color='red')    
...     return

&gt;&gt;&gt; ne_lr = LinearRegression(solver='normal_equation')
&gt;&gt;&gt; ne_lr.fit(X, y)
&gt;&gt;&gt; print('Intercept: %.2f' % ne_lr.w_[0])
Intercept: 0.00
&gt;&gt;&gt; print('Slope: %.2f' % ne_lr.w_[1])
Slope: 1.00

lin_regplot(X, y, ne_lr)
plt.show()
</code></pre>
<p><img alt="" src=".././img/regression_ols_linreg_4.png" /></p>
<p><br></p>
<h3 id="example-2-gradient-descent">Example 2 - Gradient Descent</h3>
<p>Using the gradient decent optimization algorithm, the weights are updated incrementally after each epoch (= pass over the training dataset).</p>
<p><img alt="" src=".././img/regression_ols_linreg_5.png" /></p>
<pre><code>&gt;&gt;&gt; gd_lr = LinearRegression(solver='gd', eta=0.005, epochs=1500, random_seed=0)
&gt;&gt;&gt; gd_lr.fit(X, y)
&gt;&gt;&gt; print('Intercept: %.2f' % gd_lr.w_[0])
Intercept: 0.00
&gt;&gt;&gt; print('Slope: %.2f' % gd_lr.w_[1])
Slope: 1.00
</code></pre>
<p>Visualizing the cost to check for convergence and plotting the linear model:</p>
<pre><code>&gt;&gt;&gt; plt.plot(range(1, gd_lr.epochs+1), gd_lr.cost_)
&gt;&gt;&gt; plt.xlabel('Epochs')
&gt;&gt;&gt; plt.ylabel('Cost')
&gt;&gt;&gt; plt.tight_layout()
&gt;&gt;&gt; plt.show()
</code></pre>
<p><img alt="" src=".././img/regression_ols_linreg_6.png" /></p>
<pre><code>&gt;&gt;&gt;  lin_regplot(X, y, gd_lr)
&gt;&gt;&gt;  plt.show()
</code></pre>
<p><img alt="" src=".././img/regression_ols_linreg_7.png" /></p>
<p><strong>Tip</strong>: I you are using gradient descent, consider standardizing the variables for better convergence of the algorithm.</p>
<pre><code>&gt;&gt;&gt; X_std = (X - np.mean(X)) / X.std()
&gt;&gt;&gt; y_std = (y - np.mean(y)) / y.std()

&gt;&gt;&gt; gd_lr = LinearRegression(solver='gd', eta=0.1, epochs=10, random_seed=0)
&gt;&gt;&gt; gd_lr.fit(X_std, y_std)
&gt;&gt;&gt; print('Intercept: %.2f' % gd_lr.w_[0])
Intercept: 0.00
&gt;&gt;&gt; print('Slope: %.2f' % gd_lr.w_[1])
Slope: 1.00
</code></pre>
<p><br>
<br>
<br></p>
<h3 id="example-3-stochastic-gradient-descent">Example 3 - Stochastic Gradient Descent</h3>
<p>Example 2 explained "batch" gradient descent learning. The "batch" updates refers to the fact that the cost function is minimized based on the complete training data set. In contrast, stochastic gradient descent performs the weight update incrementally after each individual training sample.</p>
<p>The process of incrementally updating the weights is also called "stochastic" gradient descent since it approximates the minimization of the cost function. Although the stochastic gradient descent approach might sound inferior to gradient descent due its "stochastic" nature and the "approximated" direction (gradient), it can have certain advantages in practice. Often, stochastic gradient descent converges much faster than gradient descent since the updates are applied immediately after each training sample; stochastic gradient descent is computationally more efficient, especially for very large datasets. </p>
<pre><code>&gt;&gt;&gt; sgd_lr = LinearRegression(solver='sgd', eta=0.1, epochs=10, random_seed=0)
&gt;&gt;&gt; sgd_lr.fit(X_std, y_std)
&gt;&gt;&gt; print('Intercept: %.2f' % sgd_lr.w_[0])
Intercept: 0.00
&gt;&gt;&gt; print('Slope: %.2f' % sgd_lr.w_[1])
Slope: 1.00

&gt;&gt;&gt; plt.plot(range(1, sgd_lr.epochs+1), sgd_lr.cost_)
&gt;&gt;&gt; plt.xlabel('Epochs')
&gt;&gt;&gt; plt.ylabel('Cost')
&gt;&gt;&gt; plt.tight_layout()
&gt;&gt;&gt; plt.show()
</code></pre>
<p><br></p>
<pre><code>&gt;&gt;&gt; plt.plot(range(1, sgd_lr.epochs+1), sgd_lr.cost_)
&gt;&gt;&gt; plt.xlabel('Epochs')
&gt;&gt;&gt; plt.ylabel('Cost')
&gt;&gt;&gt; plt.tight_layout()
&gt;&gt;&gt; plt.show()
</code></pre>
<p><img alt="" src=".././img/regression_ols_linreg_9.png" /> </p>
<hr>

<h3 id="default-parameters">Default Parameters</h3>
<pre>    class LinearRegression(object):
        """ Ordinary least squares linear regression.

        Parameters
        ------------

        solver : {'gd', 'sgd', 'normal_equation'} (default: 'normal_equation')
          Method for solving the cost function. 'gd' for gradient descent, 
          'sgd' for stochastic gradient descent, or 'normal_equation' (default)
          to solve the cost function analytically.

        eta : float (default: 0.1)
          Learning rate (between 0.0 and 1.0); 
          ignored if solver='normal_equation'.

        epochs : int (default: 50)
          Passes over the training dataset; 
          ignored if solver='normal_equation'.

        shuffle : bool (default: False)
            Shuffles training data every epoch if True to prevent circles;
            ignored if solver='normal_equation'.

        random_seed : int (default: None)
            Set random state for shuffling and initializing the weights;
            ignored if solver='normal_equation'.

        zero_init_weight : bool (default: False)
            If True, weights are initialized to zero instead of small random
            numbers in the interval [0,1];
            ignored if solver='normal_equation'

        Attributes
        -----------
        w_ : 1d-array
          Weights after fitting.

        cost_ : list
          Sum of squared errors after each epoch;
          ignored if solver='normal_equation'

        """</pre>

<hr>

<h3 id="methods">Methods</h3>
<pre>    def fit(self, X, y, init_weights=True):
        """ Fit training data.

        Parameters
        ----------
        X : {array-like, sparse matrix}, shape = [n_samples, n_features]
            Training vectors, where n_samples is the number of samples and
            n_features is the number of features.

        y : array-like, shape = [n_samples]
            Target values.

        init_weights : bool (default: True)
            (Re)initializes weights to small random floats if True.

        Returns
        -------
        self : object
        """</pre>

<pre>    def predict(self, X):
        """
        Predict target values for X.

        Parameters
        ----------
        X : {array-like, sparse matrix}, shape = [n_samples, n_features]
            Training vectors, where n_samples is the number of samples and
            n_features is the number of features.

        Returns
        ----------
        float : Predicted target value.

        """</pre></div>
            
        </div>

        <footer class="col-md-12">
            <hr>
            
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>

        <script src="../../../js/jquery-1.10.2.min.js"></script>
        <script src="../../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../../js/highlight.pack.js"></script>
        <script>var base_url = '../../..';</script>
        <script data-main="../../../mkdocs/js/search.js" src="../../../mkdocs/js/require.js"></script>
        <script src="../../../js/base.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            From here you can search these documents. Enter
                            your search terms below.
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>

    </body>
</html>
